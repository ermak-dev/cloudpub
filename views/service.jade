h1 Services
// Put controls into this div
.page
    .loading

// Module script
!= js('/js/service.js')

// Below is client-side _.templates (use <% %>!)
// Items list
script.list-template(type="text/template")
    table.bordered-table.zebra-striped
        thead
            tr
                th.state Service
                th.domain App
                th.domain Server
                th.worker Work Queue
                th.control &nbsp;
        tbody
            <% _.each(items, function(item) { %>
            tr
                td.state
                    .state-icon
                        a(href="#", title="<%=item.state%>: <%=item.message%>")
                            img(src="state-<%=item.state%>.png")
                            .state-hole <%= item.workers && item.workers.length || 0 %>
                    .state-info
                        h3 <%=item.entity %>
                        span <%= item.message %> 
                td.domain
                    h3
                        <%=item.app%>
                 td.domain
                    h3
                        <%=item.instance%>
                td.worker
                    ul.state-list
                        <% _.each(item._children, function(worker) { %>
                        li
                            .state-icon-small
                                img(src="state-<%=worker.state%>.png")
                                input(type="checkbox",name="instance", value="<%= worker.id %>", checked="true")
                            .state-info-small <%= worker.message %>
                        <% }); %>
                td.control
                    <% if(item.state != "up") { %>
                    img.btn.command(src="command-start.png",data-id="<%=item.id%>",data-command="startup")
                    <% } if(item.state != "down") { %>
                    img.btn.command(src="command-stop.png",data-id="<%=item.id%>",data-command="shutdown")
                    <% } %>
            <% }); %>

// Start dialog
script.startup-template(type="text/template")
    .start.modal.hide.fade
        .modal-header
            a.close(href="#") × 
            h3 Start Service
        form.modal-body
            .clearfix
        .modal-footer
            a.btn.primary.execute(href="#") Restart Service
            a.btn.secondary.cancel(href="#") Cancel

// Stop dialog
script.shutdown-template(type="text/template")
    .modal.hide.fade
        .modal-header
            a.close(href="#") × 
            h3 Stop Service
        form.modal-body
            .clearfix
        .modal-footer
            a.btn.primary.execute(href="#") Stop Service
            a.btn.secondary.cancel(href="#") Cancel

