---
sidebar_position: 99
slug: /cli
---

# Параметры командной строки

clo предоставляет следующие параметры командной строки:

```bash
Использование: clo [Опции] <Команда>

Команды:
  login      Аутенфикация на сервере
  logout     Завершение работы
  publish    Добавить ресурс и запустить агент
  register   Добавить ресурс без запуска агента
  unpublish  Удалить ресурс
  ls         Вывести список ресурсов
  run        Запустить агент и опубликованные ресурсы
  start      Запустить публикацию ресурса (при работающем агенте)
  stop       Остановить публикацию ресурса (при работающем агенте)
  clean      Удалить все ресурсы
  purge      Очистить кеш (загрузки и установленные сторонние приложения)
  options    Вывести список параметров конфигурации
  set        Установить значение параметра конфигурации
  get        Получить значение параметра конфигурации
  ping       Проверить пинг до сервера
  service    Работа с сервисом
  upgrade    Обновить приложение до последней версии
  help       Помощь

Опции:
  -v, --verbose                Выводить лог в консоль
  -l, --log-level <LOG_LEVEL>  Уровень логирования, по умолчанию: "error".
                               Возможные значения: "error", "warn", "info", "debug"
  -c, --conf <CONF>            Путь к файлу конфигурации
  -h, --help                   Показать справку
  -V, --version                Показать номер версии
```

## Описание команд

### Аутенфикация на сервере

```bash
clo login <email> [--password password]
```

Аутентифицируется на сервере с использованием email и пароля, и сохраняет API токен в файл конфигурации.

Если пароль не указан в качестве аргумента командной строки, команда запросит его или использует переменную окружения `CLO_PASSWORD`, если она установлена.

### Завершение работы

```bash
clo logout
```

Удаляет сохраненный API токен из файла конфигурации.

### Добавить ресурс и запустить агент

```bash
clo publish [--name имя_сервиса] [--auth тип_авторизации] [--acl email:роль] [--header name:value] <протокол> <порт|хост:порт|путь|строка подключения>
```

#### Параметры

- `протокол` - протокол, по которому доступен ресурс (http, https, tcp, udp, 1c)
- `порт` - номер порта, на котором доступен ресурс
- `хост` - адрес хоста, на котором доступен ресурс. Если хост не указан, используется `localhost`
- `путь` - для протокола 1с - путь до каталога БД 1С
- `строка подключения` - для протокола 1с - строка подключения к БД 1С

#### Опции

- `--name` - опциональное имя сервиса для отображение в личном кабинете
- `--auth` - тип авторизации для доступа к ресурсу. Возможные значения:
  - `none` - без авторизации
  - `basic` - HTTP Basic Auth
- `--acl` - Правило доступа к ресурсу. Правило может быть несколько. Каждое правило имеет вид `email:роль`, где:
  - `email` - адрес электронной почты пользователя
  - `роль` - роль пользователя. Возможные значения:
    - `admin` - администратор
    - `reader` - пользователь с правами на чтение
    - `writer` - пользователь с правами на запись (только для протокола `webdav`)
- `--header` - HTTP заголовок для запроса. Заголовок может быть несколько. Каждое правило имеет вид `name:value`, где:
  - `name` - имя заголовка
  - `value` - значение заголовка

После публикации ресурс добавляется в файл конфигурации и приложение запускается.

Если вам нужно просто добавить ресурс в файл конфигурации, используйте команду `register`

После этого вы можете запустить приложение с помощью команды `run`

### Добавить ресурс без запуска агента

```bash
clo register [--name имя_сервиса] [--auth тип_авторизации] [--acl email:роль] [--header name:value] <протокол> <порт|хост:порт|путь|строка подключения>
```

Добавляет ресурс в файл конфигурации без запуска агента. Параметры такие же как для команды `publish`.

### Удалить ресурс

```bash
clo unpublish <guid сервиса>
```

Снимает ресурс с публикации.

### Вывести список ресурсов

```bash
clo ls
```

### Запустить агент и опубликованные ресурсы

```bash
clo run
```

Запускает агент и все ранее сохраненные ресурсы.

### Запустить публикацию ресурса (при работающем агенте)

```bash
clo start <guid сервиса>
```

Запускает публикацию конкретного ресурса при работающем агенте.

### Остановить публикацию ресурса (при работающем агенте)

```bash
clo stop <guid сервиса>
```

Останавливает публикацию конкретного ресурса при работающем агенте.

### Удалить все ресурсы

```bash
clo clean
```

Останавливает и удаляет все ресурсы

### Очистить кеш (загрузки и установленные сторонние приложения)

```bash
clo purge
```

Удаляет все временные файлы созданные в процессе работы (загрузки и установленные сторонние приложения).

### Установить значение параметра конфигурации

```bash
clo set <key> <value>
```

Значение key может быть одним из следующих:

| Значение | Описание | Значение по умолчанию|
| --- | --- | --- |
|`token`|Токен доступа к API из личного кабинета|Нет|
|`server`|URL сервера CloudPub|`https://cloudpub.ru`|
|`1c_platform`|Архитектура платформы 1С (x64/x86)|`x64`|
|`1c_home`|Путь до папки в которую установлен 1С|Windows:<br/>`C:\Program Files\1cv8`<br/>Linux:<br/>`/opt/1C`|
|`1c_publish_dir`|Путь до каталога с файлами публикаций 1С (`default.vrd`)|Windows:<br/>`%APPDATA%/cloudpub/1c`<br/>Linux: `~/.cache/cloudpub/1c`|
|`minecraft_server`|URL для загрузки сервера Minecraft или локальный путь до jar|[`server.jar`](https://piston-data.mojang.com/v1/objects/45810d238246d90e811d896f87b14695b7fb6839/server.jar)|
|`minecraft_java_opts`|Опции Java для сервера Minecraft|`-Xmx2048M -Xms2048M`|
|`usafe_tls`|Игнорировать проверку сертификата сервера|`false`|
|`hwid`|Уникальный идентификатор устройства (HWID)|Сгенерирован автоматически при первом запуске|


### Получить значение параметра конфигурации

```bash
clo get <key>
```

Значение key такое же как для команды `set`

### Проверить пинг до сервера

```bash
clo ping
```

### Установка и работа с сервисом

Вы можете установить приложение как сервис, чтобы оно автоматически запускалось при загрузке системы и работало в фоновом режиме.

:::info
Команды для установки и работы с сервисом так же требуют прав суперпользователя, поэтому вам может понадобиться использовать `sudo` перед командами.

На Windows команды для установки и работы с сервисом требуют прав администратора, поэтому вам может понадобиться запускать консоль от имени администратора.

На Linux сервис будет запущен под пользователем `root`, поэтому вы должны конфигурировать ключ API и другие параметры конфигурации так же под этим пользователем.
:::

#### Установка сервиса

```bash
clo service install
```
Устанавливает приложение в качестве сервиса

#### Запуск сервиса

```bash
clo service start
```
Запускает приложение как сервис

#### Остановка сервиса

```bash
clo service stop
```
Останавливает приложение как сервис

#### Статус сервиса

```bash
clo service status
```
Показывает статус сервиса

#### Удаление сервиса

```bash
clo service uninstall
```
Удаляет приложение как сервис

### Обновить приложение до последней версии

```bash
clo upgrade
```

Обновляет приложение до последней версии.

### Помощь

```bash
clo help [команда]
```

Показывает справку по использованию команд. Если указана конкретная команда, показывает подробную справку по ней.
