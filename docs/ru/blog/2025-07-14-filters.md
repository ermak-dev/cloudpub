---
slug: trafic-filters
title: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ CloudPub
image: /img/datafilter.png
tags: ["–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å"]
---

![–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞](/img/datafilter.png)

# –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ–º –º–æ—â–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

–ú—ã —Ä–∞–¥—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –æ–¥–Ω—É –∏–∑ —Å–∞–º—ã—Ö –æ–∂–∏–¥–∞–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π CloudPub ‚Äî **—Å–∏—Å—Ç–µ–º—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞**! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–∏–±–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–∞—à–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

<!--truncate-->

## –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞?

–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å ‚Äî –≤–∞–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, –∫—Ç–æ –∏ –∫–∞–∫ –∫ –Ω–µ–º—É –æ–±—Ä–∞—â–∞–µ—Ç—Å—è. –°–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ CloudPub –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- üõ°Ô∏è **–ó–∞—â–∏—Ç–∏—Ç—å** –≤–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã –æ—Ç –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- üåç **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø** –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É
- üîí **–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å** –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞ –∏ –ø–æ—Ä—Ç—ã
- üìä **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å** HTTP-–∑–∞–ø—Ä–æ—Å—ã –ø–æ –º–µ—Ç–æ–¥–∞–º –∏ –ø—É—Ç—è–º
- ‚ö° **–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å** —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏


## –ß—Ç–æ –º–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å?

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–∏–Ω—Ç–∞–∫—Å–∏—Å, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ Wireshark**, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –∑–Ω–∞–∫–æ–º–æ–π –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

### IP-–∞–¥—Ä–µ—Å–∞ –∏ –ø–æ—Ä—Ç—ã
```
# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IP
ip.src == 192.168.1.100

# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å
ip.src >= 192.168.1.0 and ip.src <= 192.168.1.255

# –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã
port.src <= 1024
```

### HTTP-—Ç—Ä–∞—Ñ–∏–∫
```
# –ó–∞—â–∏—Ç–∏—Ç—å –∞–¥–º–∏–Ω–∫—É
http.path matches "^/admin.*"

# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ API
http.path starts_with "/api/"

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –º–µ—Ç–æ–¥–∞–º
http.method == "GET"
```

### –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
```
# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –º–µ—Å—Ç–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫
geo.country == "Russia"

# –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
geo.code == "US" or geo.code == "UA"
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞—â–∏—Ç–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∞–¥–º–∏–Ω–∫–æ–π. –í—ã —Ö–æ—Ç–∏—Ç–µ:

1. –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ User-Agent'—ã
2. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

```
# –ü—Ä–∞–≤–∏–ª–æ 1: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–æ–≤
http.headers["User-Agent"] contains "bot"

# –ü—Ä–∞–≤–∏–ª–æ 2: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤
http.method == "POST" and http.headers["Content-Length"] > 10000000
```

## –¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ:

- **–†–∞–∑—Ä–µ—à–∏—Ç—å** ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫
- **–ó–∞–ø—Ä–µ—Ç–∏—Ç—å** ‚Äî –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- **–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å** ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π –∞–¥—Ä–µ—Å (—Ç–æ–ª—å–∫–æ HTTP)

## –°–æ–≤–µ—Ç—ã –ø–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 1. –ü–æ—Ä—è–¥–æ–∫ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
–ü—Ä–∞–≤–∏–ª–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É. –†–∞–∑–º–µ—â–∞–π—Ç–µ –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤—ã—à–µ:

```
# –°–Ω–∞—á–∞–ª–∞ —Ä–∞–∑—Ä–µ—à–∞–µ–º –∞–¥–º–∏–Ω–∞–º
ip.src == 1.2.3.4 and http.path starts_with "/admin/"

# –ü–æ—Ç–æ–º –±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º
http.path starts_with "/admin/"
```

### 2. –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —É—Å–ª–æ–≤–∏—è

–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞, –∫–æ–º–±–∏–Ω–∏—Ä—É—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π:

```
# –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å POST-–∑–∞–ø—Ä–æ—Å—ã –∫ API –æ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö IP
http.method == "POST" and
http.path starts_with "/api/" and
not (ip.src >= 192.168.1.0 and ip.src <= 192.168.1.255) and
not http.headers["Authorization"] contains "Bearer"
```

## –ó–Ω–∞–∫–æ–º—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

–ï—Å–ª–∏ –≤—ã —É–∂–µ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å **Wireshark**, —Ç–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤ CloudPub –ø–æ–∫–∞–∂–µ—Ç—Å—è –≤–∞–º –∑–Ω–∞–∫–æ–º—ã–º! –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –ø—Ä–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–∞–≤–∏–ª –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

```
# –ü—Ä–∏–≤—ã—á–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
ip.src == 192.168.1.1 and tcp.port == 80
http.request.method == "GET"
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

- ‚ö° –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ (IP, –ø–æ—Ä—Ç—ã) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã
- üîç –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- üìä –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±—ã—Å—Ç—Ä—ã–µ in-memory –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- üöÄ –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –≤ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥

## –ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —Å–µ–≥–æ–¥–Ω—è

–°–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–æ –≤—Å–µ—Ö –ø–ª–∞–Ω–∞—Ö CloudPub. –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è CloudPub
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ü—É–±–ª–∏–∫–∞—Ü–∏–∏"
3. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω—É–∂–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ü—Ä–∞–≤–∏–ª–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏"
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ —Ä–∞–±–æ—Ç—É

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ú—ã –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –í –±–ª–∏–∂–∞–π—à–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:

- üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
- üîÑ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ threat intelligence –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏

---

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏!** –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ [–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞](/filter).

*–ö–æ–º–∞–Ω–¥–∞ CloudPub*
